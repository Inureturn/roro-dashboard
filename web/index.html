<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RoRo Fleet Dashboard</title>
  <link href='https://unpkg.com/maplibre-gl@5.8.0/dist/maplibre-gl.css' rel='stylesheet' />
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <div id="app">
    <!-- Header -->
    <header class="dashboard-header">
      <div class="header-content">
        <h1>ğŸš¢ RoRo Fleet Dashboard</h1>
        <div class="header-stats">
          <span class="stat"><span class="stat-label">Total Vessels:</span> <span id="total-vessels">0</span></span>
          <span class="stat"><span class="stat-label">Active:</span> <span id="active-vessels">0</span></span>
          <span class="stat"><span class="stat-label">Last Update:</span> <span id="last-update">Never</span></span>

          <div class="header-controls">
            <button class="icon-btn" id="theme-toggle" title="Toggle theme">ğŸŒ™</button>
            <button class="icon-btn" id="lang-toggle" title="Switch language">ğŸŒ</button>
            <button class="info-btn" id="system-info-btn" title="System Info">â„¹ï¸</button>
          </div>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <div class="dashboard-main">
      <!-- Vessel List Sidebar -->
      <aside class="vessel-sidebar">
        <div class="sidebar-header">
          <h2>Fleet</h2>
          <div class="filter-tabs">
            <button class="filter-tab active" data-filter="my-fleet">My Fleet</button>
            <button class="filter-tab" data-filter="tracked">All Tracked</button>
          </div>
          <input type="text" id="vessel-search" placeholder="Search vessels..." class="search-input">
        </div>
        <div id="vessel-list" class="vessel-list">
          <div class="loading">Loading vessels...</div>
        </div>
      </aside>

      <!-- Map Container -->
      <div class="map-container">
        <div id="stale-data-warning" class="stale-data-warning hidden">
          âš ï¸ Data may be outdated. Last AIS update received more than 5 minutes ago.
        </div>
        <div id="map"></div>
        <div class="map-attribution">
          Â© <a href="https://www.maptiler.com/copyright/" target="_blank">MapTiler</a> Â© <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors
        </div>
      </div>

      <!-- Vessel Details Panel (Initially Hidden) -->
      <aside class="vessel-details hidden" id="vessel-details">
        <div class="details-header">
          <h2 id="details-title">Vessel Details</h2>
          <button class="close-btn" id="close-details">&times;</button>
        </div>
        <div class="details-content" id="details-content">
          <div class="loading">Select a vessel to view details</div>
        </div>
      </aside>
    </div>

    <!-- System Info Modal -->
    <div id="system-info-modal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h3>System Information</h3>
          <button class="close-btn" id="close-info-modal">&times;</button>
        </div>
        <div class="modal-body">
          <div class="info-section">
            <h4>ğŸ“¡ Data Collection</h4>
            <p><strong>Rate Limit:</strong> 100m or 180s (smart filtering)</p>
            <p><strong>Updates:</strong> ~10,000 positions/day</p>
            <p><strong>Accuracy:</strong> 1 football field (100m)</p>
          </div>

          <div class="info-section">
            <h4>ğŸ—„ï¸ Data Retention</h4>
            <p><strong>Keep:</strong> Last 90 days of positions</p>
            <p><strong>Cleanup:</strong> Runs daily at 2am</p>
            <p><strong>Storage:</strong> <span id="db-size-estimate">~50 MB</span></p>
          </div>

          <div class="info-section">
            <h4>âš¡ Performance</h4>
            <p><strong>View Refresh:</strong> Every 5 minutes</p>
            <p><strong>Real-time:</strong> Instant position updates</p>
            <p><strong>Trail Length:</strong> Last 50 positions</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="/main.js"></script>
</body>
</html>
